<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../app-layout/app-layout.html">
<link rel="import" href="../paper-tabs/paper-tabs.html">
<link rel="import" href="../iron-pages/iron-pages.html">
<link rel="import" href="../lrnsys-layout/lrnsys-dialog.html">
<link rel="import" href="hax-manager-source.html">

<!--
`hax-manager`
A LRN element for brokering the UI for api endpoints both in querying and uploading of new media to eventually bubble up an event for hax-body to have content inserted into it. This is a wiring closet of sorts to ensure we can talk to any backend that's returning a slew of widgets / media to insert.

@demo demo/index.html

@microcopy - the mental model for this element
 - hax-manager - the modal for selecting a source for getting something added to hax-body. This will bubble an event up to an app which will then invoke the haxInsert function on hax-body in order to get the selected item onto the body area for usage.
 - hax-body - the body tag that's beening clicked / focused and built; our WYSIWYG replacement.
 - hax-panel - a panel off to the side that has possible options. Clicking in this panel is most likely what invokes hax-manager to display though this is also managed by a higher app (lrnapp-book in initial development)
 - source - an API end point for querying and returning possible items for insert. For example, if a youtube is a source then it'll be expected to return data that can be mapped in such a way that it can display a grid of videos. Hitting vimeo we'd expect the same thing; enough data to be able to assemble a grid of videos to select / work with.
 - endpoints - much of hax-manager is about routing data to and from the current application to backends. So uploads need to go some place, this is managing the UI aspect of that transaction while expecting to be fed an endpoint to handle the backend aspect.

-->

<dom-module id="hax-manager">
  <template>
    <style>
      :host {
        display: block;
        --hax-manager-steps-color: #99DDDD;
        --hax-manager-pages-color: #99DDDD;
        --hax-manager-sources-color: #99DDDD;
        --hax-manager-header: #009688;
        --hax-manager-ink-color: white;
      }
      lrnsys-dialog {
        --lrnsys-dialog-header-padding: 0;
        --lrnsys-dialog-header-margin: 0;
      }
      .steps-tabs,
      .pages-tabs,
      .sources-tabs {
        --paper-tabs-selection-bar-color: var(--hax-manager-steps-color);
        --paper-tabs-container: {
          margin: 0;
          display: flex;
          align-items: flex-end;
          height: 80px;
          background: var(--hax-manager-header);
          color: var(--hax-manager-ink-color);
        };
        --paper-tab-content-unselected: {
          opacity: .8;
          background-color: blue;
        };
        --paper-tab-ink: var(--hax-manager-ink-color);
        --paper-tab: {
          font-family: 'Roboto', 'Noto', sans-serif;
          -webkit-font-smoothing: antialiased;
          width: 100%;
          text-transform: uppercase;
          margin-bottom: 1px;
        };
      }
    </style>
    <lrnsys-dialog modal body-append id="dialog" title="[[managerAction]]" header="[[managerTitle]]">
      <div id="header" slot="header">
        <paper-tabs class="steps-tabs" selected="{{activeStep}}" scrollable fit-container>
          <paper-tab>Select</paper-tab>
          <paper-tab>Configure</paper-tab>
          <paper-tab>Preview<paper-tab>
        </paper-tabs>
      </div>

      <div id="managerbody">
        <iron-pages
          selected="{{activeStep}}"
          fallback-selection="select"
          role="main">
          <div data-value="select">
            <paper-tabs class="pages-tabs" selected="{{activePage}}" scrollable fit-container>
              <paper-tab>Link</paper-tab>
              <paper-tab>Upload</paper-tab>
              <paper-tab>Browse</paper-tab>
            </paper-tabs>
            <iron-pages
              selected="{{activePage}}"
              fallback-selection="link">
              <div>
                <paper-input label="URL"></paper-input>
                <paper-button confirm raised>Next</paper-button>
              </div>
              <div>
                <slot name="upload"></slot>
              </div>
              <div>
                <paper-tabs class="sources-tabs" selected="{{activeSource}}" scrollable fit-container>
                  <paper-tab>My media</paper-tab>
                  <paper-tab>Youtube</paper-tab>
                  <paper-tab>Vimeo</paper-tab>
                </paper-tabs>
                <iron-pages
                  selected="{{activeSource}}"
                  fallback-selection="my-media">
                  <slot name="sources"></slot>
                </iron-pages>
              </div>
            </iron-pages>
          </div>
          <div>CONFIGURE THE THING SELECTED</div>
          <div>PREVIEW AT THE END
            <paper-button confirm raised>Insert</paper-button>
            <paper-button raised>Cancel</paper-button>
          </div>
          </iron-pages>
        </div>
      </div>
    </lrnsys-dialog>
  </template>

  <script>
    Polymer({

      is: 'hax-manager',
      listeners: {
        'hax-content-insert': 'toggleDialog',
      },
      properties: {
        /**
         * Title when open.
         */
        managerTitle: {
          type: String,
          value: 'Insert item',
        },
        /**
         * Call to action for the user.
         */
        managerAction: {
          type: String,
          value: 'Open media manager',
        },
        /**
         * Active step currently selected
         */
        activeStep: {
          type: String,
        },
        /**
         * Active page currently selected
         */
        activePage: {
          type: String,
        },
       /**
         * Active source currently selected
         */
        activeSource: {
          type: String,
        },
      },
      /**
       * Toggle ourselves.
       */
      toggleDialog: function(e) {
        this.$.dialog.toggleDialog();
      }
    });
  </script>
</dom-module>